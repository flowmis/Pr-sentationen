<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Volleyball-Turnierplan</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
            background-color: #f9f9f9;
        }
        h1, h2, h3 {
            text-align: center;
            color: #333;
        }
        .container {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
        }
        .field {
            margin: 10px;
            flex: 1;
            min-width: 300px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            background-color: #fff;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f0f0f0;
        }
        p {
            text-align: center;
            color: #555;
        }
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
        }
        .past {
            background-color: #ffdddd;
        }
        .current {
            background-color: #ddffdd;
        }
        .next {
            background-color: #fffacd;
        }
        .team-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .score-container {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .score-input {
            width: 50px;
            padding: 5px;
            margin: 0 10px;
        }
        .team-name {
            flex-grow: 1;
            text-align: left;
        }
        .match {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .button-container {
            text-align: center;
            margin-top: 20px;
        }
        .result-container {
            margin-bottom: 40px;
        }
        .result-table {
            width: 100%;
            border-collapse: collapse;
            background-color: #fff;
        }
        .result-table th, .result-table td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
        }
        .result-table th {
            background-color: #f0f0f0;
        }
    </style>
</head>
<body>
    <h1>Weihnachtsvolleyballturnier Technische Schule Aalen</h1>
    <h2>Gruppenphase (08:10 - 10:40 Uhr)</h2>
    <div class="container"></div>
    <div class="button-container"></div>
    
    <script>
      const team = {
        a: "Pritsch Perfect",
        b: "Gladiators",
        c: "Juventus Urin",
        d: "Tassive Mitten",
        e: "Hört man mich überhaupt",
        f: "Passt scho",
        g: "Knockout",
        h: "Die AufReißer",
        i: "Rohmilch",
        j: "5 gegen Tom",
        k: "Iceböörg",
        l: "The Underdog",
        m: "TG11I",
        n: "Blockbuster",
        o: "Fc Asylheim",
        p: "SV Wacker Durchschlagen",
        q: "Soooo isch",
        r: "VABO2"
      };

      const scheduleA = [
        { time: "8:10", match: [team.a, team.b], score: [13, 2] },
        { time: "8:10", match: [team.a, team.c], score: [1, 2] },
        { time: "8:20", match: [team.a, team.d], score: [3, 0] },
        { time: "8:30", match: [team.a, team.e], score: [2, 1] },
        { time: "8:40", match: [team.a, team.f], score: [4, 1] },
        { time: "8:50", match: [team.b, team.c], score: [0, 3] },
        { time: "9:00", match: [team.b, team.d], score: [2, 2] },
        { time: "9:10", match: [team.b, team.e], score: [1, 1] },
        { time: "9:20", match: [team.b, team.f], score: [0, 2] },
        { time: "9:30", match: [team.c, team.d], score: [3, 4] },
        { time: "9:40", match: [team.c, team.e], score: [1, 0] },
        { time: "9:50", match: [team.c, team.f], score: [2, 3] },
        { time: "10:00", match: [team.d, team.e], score: [1, 4] },
        { time: "10:10", match: [team.d, team.f], score: [2, 0] },
        { time: "10:20", match: [team.e, team.f], score: [3, 3] },
      ];

      const scheduleB = [
        { time: "8:10", match: [team.g, team.h], score: [1, 2] },
        { time: "8:20", match: [team.g, team.i], score: [3, 0] },
        { time: "8:30", match: [team.g, team.j], score: [2, 1] },
        { time: "8:40", match: [team.g, team.k], score: [4, 1] },
        { time: "8:50", match: [team.g, team.l], score: [0, 3] },
        { time: "9:00", match: [team.h, team.i], score: [2, 2] },
        { time: "9:10", match: [team.h, team.j], score: [1, 1] },
        { time: "9:20", match: [team.h, team.k], score: [0, 2] },
        { time: "9:30", match: [team.h, team.l], score: [3, 4] },
        { time: "9:40", match: [team.i, team.j], score: [1, 0] },
        { time: "9:50", match: [team.i, team.k], score: [2, 3] },
        { time: "10:00", match: [team.i, team.l], score: [1, 4] },
        { time: "10:10", match: [team.j, team.k], score: [2, 0] },
        { time: "10:20", match: [team.j, team.l], score: [3, 3] },
        { time: "10:30", match: [team.k, team.l], score: [0, 3] },
      ];

      const scheduleC = [
        { time: "8:10", match: [team.m, team.n], score: [1, 22] },
        { time: "8:20", match: [team.m, team.o], score: [3, 0] },
        { time: "8:30", match: [team.m, team.p], score: [2, 1] },
        { time: "8:40", match: [team.m, team.q], score: [4, 1] },
        { time: "8:50", match: [team.m, team.r], score: [0, 3] },
        { time: "9:00", match: [team.n, team.o], score: [2, 2] },
        { time: "9:10", match: [team.n, team.p], score: [1, 1] },
        { time: "9:20", match: [team.n, team.q], score: [0, 2] },
        { time: "9:30", match: [team.n, team.r], score: [3, 4] },
        { time: "9:40", match: [team.o, team.p], score: [1, 0] },
        { time: "9:50", match: [team.o, team.q], score: [2, 3] },
        { time: "10:00", match: [team.o, team.r], score: [1, 4] },
        { time: "10:10", match: [team.p, team.q], score: [2, 0] },
        { time: "10:20", match: [team.p, team.r], score: [3, 3] },
        { time: "10:30", match: [team.q, team.r], score: [0, 3] },
      ];

      // Gruppen-Map um einfach auf die richtigen Schedules zugreifen zu können
      const groups = {
        "Feld 1: Gruppe A": scheduleA,
        "Feld 2: Gruppe B": scheduleB,
        "Feld 3: Gruppe C": scheduleC
      };

      // Tabelle Gruppenphase
      function generateTable(schedule, groupName, fieldId) {
        const tableContainer = document.createElement("div");
        const heading = document.createElement("h3");
        heading.innerText = groupName;  
        tableContainer.appendChild(heading);  
        const table = document.createElement("table");
        table.innerHTML = `
          <tr>
            <th>Zeit</th>
            <th>Spiel</th>
          </tr>
        `;
        schedule.forEach(({ time, match, score }) => {
          const row = document.createElement("tr");
          row.dataset.time = time;
          row.innerHTML = `
            <td>${time}</td>
            <td class="match">
              <div class="team-container">
                <span class="team-name">${match[0]}</span>
              </div>
              :
              <div class="team-container">
                <span class="team-name">${match[1]}</span>
              </div>
              <div class="score-container">
                <input class="score-input" type="number" min="0" value="${score[0]}" data-team="${match[0]}" />
                <span>:</span>
                <input class="score-input" type="number" min="0" value="${score[1]}" data-team="${match[1]}" />
              </div>
            </td>
          `;
          table.appendChild(row);
        });
        const button = document.createElement("button");
        button.innerText = `Auswertung`;
        button.classList.add("auswertung-button");
        button.addEventListener("click", () => evaluateScores(groupName, `resultTableField${fieldId}`));
        tableContainer.appendChild(table);
        tableContainer.appendChild(button);
        return tableContainer;
      }

      document.addEventListener("DOMContentLoaded", () => {
        const container = document.querySelector(".container");
        container.appendChild(generateTable(scheduleA, "Feld 1: Gruppe A", 1));
        container.appendChild(generateTable(scheduleB, "Feld 2: Gruppe B", 2));
        container.appendChild(generateTable(scheduleC, "Feld 3: Gruppe C", 3));
        updateColors();
        setInterval(updateColors, 600);
      });

      // Farbe in Tabellen anpassen
      function updateColors() {
        const now = new Date();
        const currentTime = now.getHours() * 60 + now.getMinutes();
        document.querySelectorAll("table tr[data-time]").forEach(row => {
          const [hours, minutes] = row.dataset.time.split(":").map(Number);
          const rowTime = hours * 60 + minutes;
          const endTime = rowTime + 10; 
          row.classList.remove("past", "current", "next");
          if (rowTime + 10 < currentTime) { 
            row.classList.add("past"); 
          } else if (rowTime <= currentTime && endTime >= currentTime) { 
            row.classList.add("current"); 
          } else if (rowTime - currentTime < 11) { 
            row.classList.add("next"); 
          }
        });
      }

      // Auswertungs-Funktion
      function evaluateScores(groupName, resultTableId) {
        const schedule = groups[groupName] || [];
        // Datensammlung
        const results = {};

        // Alle zugehörigen Tabellenzeilen für diese Gruppe finden:
        // Da wir die Tabellen dynamisch erzeugen, suchen wir anhand des groupName im DOM.
        const allTables = document.querySelectorAll("h3");
        let parentTable;
        allTables.forEach(h3 => {
          if (h3.innerText === groupName) {
            parentTable = h3.parentNode.querySelector("table");
          }
        });

        if (!parentTable) return;

        const rows = parentTable.querySelectorAll("tr[data-time]");
        rows.forEach(row => {
          const inputs = row.querySelectorAll(".score-input");
          if (inputs.length === 2) {
            const team1 = inputs[0].dataset.team;
            const team2 = inputs[1].dataset.team;
            const score1 = parseInt(inputs[0].value, 10) || 0;
            const score2 = parseInt(inputs[1].value, 10) || 0;

            if (!results[team1]) results[team1] = { wins: 0, scored: 0, allowed: 0 };
            if (!results[team2]) results[team2] = { wins: 0, scored: 0, allowed: 0 };

            results[team1].scored += score1;
            results[team1].allowed += score2;
            results[team2].scored += score2;
            results[team2].allowed += score1;

            if (score1 > score2) {
              results[team1].wins += 1;
            } else if (score2 > score1) {
              results[team2].wins += 1;
            }
          }
        });

        // Ergebnisse sortieren
        const sortedResults = Object.keys(results).map(teamName => {
          return {
            team: teamName,
            wins: results[teamName].wins,
            diff: results[teamName].scored - results[teamName].allowed
          };
        }).sort((a, b) => {
          // Sortierung: Erst nach Siegen, dann nach Punktedifferenz
          if (b.wins !== a.wins) return b.wins - a.wins;
          return b.diff - a.diff;
        });

        // Tabelle leeren und neu aufbauen
        const resultContainer = document.getElementById(resultTableId);
        const tbody = resultContainer.querySelector("tbody");
        tbody.innerHTML = "";

        sortedResults.forEach((res, index) => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${index + 1}</td>
            <td>${res.team}</td>
            <td>${res.wins}</td>
            <td>${res.diff}</td>
          `;
          tbody.appendChild(tr);
        });
      }
    </script>

    <div class="result-container" id="resultTableField1">
      <h3>Ergebnisse für Gruppe A</h3>
      <table class="result-table">
        <thead>
          <tr>
            <th>Platz</th>
            <th>Team</th>
            <th>Siege</th>
            <th>Punktedifferenz</th>
          </tr>
        </thead>
        <tbody>
          <!-- Ergebnisse hier -->
        </tbody>
      </table>
    </div>
    <div class="result-container" id="resultTableField2">
      <h3>Ergebnisse für Gruppe B</h3>
      <table class="result-table">
        <thead>
          <tr>
            <th>Platz</th>
            <th>Team</th>
            <th>Siege</th>
            <th>Punktedifferenz</th>
          </tr>
        </thead>
        <tbody>
          <!-- Ergebnisse hier -->
        </tbody>
      </table>
    </div>
    <div class="result-container" id="resultTableField3">
      <h3>Ergebnisse für Gruppe C</h3>
      <table class="result-table">
        <thead>
          <tr>
            <th>Platz</th>
            <th>Team</th>
            <th>Siege</th>
            <th>Punktedifferenz</th>
          </tr>
        </thead>
        <tbody>
          <!-- Ergebnisse hier -->
        </tbody>
      </table>
    </div>

    <h2>Platzierungsspiele (10:50 - 11:50 Uhr)</h2>
    <div class="container">
      <div class="field">
        <h3>Feld 1</h3>
        <table>
          <tr>
            <th>Zeit</th>
            <th>Spiel</th>
          </tr>
          <tr data-time="10:50"><td>10:50</td><td><input type="text" placeholder="1. Gruppe A" /> vs <input type="text" placeholder="1. Gruppe B" /></td></tr>
          <tr data-time="10:50"><td>11:00</td><td><input type="text" placeholder="1. Gruppe A" /> vs <input type="text" placeholder="1. Gruppe C" /></td></tr>
          <tr data-time="10:50"><td>11:10</td><td><input type="text" placeholder="1. Gruppe C" /> vs <input type="text" placeholder="1. Gruppe B" /></td></tr>
          <tr data-time="10:50"><td>11:20</td><td><input type="text" placeholder="2. Gruppe A" /> vs <input type="text" placeholder="2. Gruppe B" /></td></tr>
          <tr data-time="10:50"><td>11:30</td><td><input type="text" placeholder="2. Gruppe A" /> vs <input type="text" placeholder="2. Gruppe C" /></td></tr>
          <tr data-time="10:50"><td>11:40</td><td><input type="text" placeholder="2. Gruppe C" /> vs <input type="text" placeholder="2. Gruppe B" /></td></tr>
        </table>
      </div>
      
      <div class="field">
        <h3>Feld 2</h3>
        <table>
          <tr>
            <th>Zeit</th>
            <th>Spiel</th>
          </tr>
          <tr data-time="10:50"><td>10:50</td><td><input type="text" placeholder="3. Gruppe A" /> vs <input type="text" placeholder="3. Gruppe B" /></td></tr>
          <tr data-time="10:50"><td>11:00</td><td><input type="text" placeholder="3. Gruppe A" /> vs <input type="text" placeholder="3. Gruppe C" /></td></tr>
          <tr data-time="10:50"><td>11:10</td><td><input type="text" placeholder="3. Gruppe C" /> vs <input type="text" placeholder="3. Gruppe B" /></td></tr>
          <tr data-time="10:50"><td>11:20</td><td><input type="text" placeholder="4. Gruppe A" /> vs <input type="text" placeholder="4. Gruppe B" /></td></tr>
          <tr data-time="10:50"><td>11:30</td><td><input type="text" placeholder="4. Gruppe A" /> vs <input type="text" placeholder="4. Gruppe C" /></td></tr>
          <tr data-time="10:50"><td>11:40</td><td><input type="text" placeholder="4. Gruppe C" /> vs <input type="text" placeholder="4. Gruppe B" /></td></tr>
        </table>
      </div>

      <div class="field">
        <h3>Feld 3</h3>
        <table>
          <tr>
            <th>Zeit</th>
            <th>Spiel</th>
          </tr>
          <tr data-time="10:50"><td>10:50</td><td><input type="text" placeholder="5. Gruppe A" /> vs <input type="text" placeholder="5. Gruppe B" /></td></tr>
          <tr data-time="10:50"><td>11:00</td><td><input type="text" placeholder="5. Gruppe A" /> vs <input type="text" placeholder="5. Gruppe C" /></td></tr>
          <tr data-time="10:50"><td>11:10</td><td><input type="text" placeholder="5. Gruppe C" /> vs <input type="text" placeholder="5. Gruppe B" /></td></tr>
          <tr data-time="10:50"><td>11:20</td><td><input type="text" placeholder="6. Gruppe A" /> vs <input type="text" placeholder="6. Gruppe B" /></td></tr>
          <tr data-time="10:50"><td>11:30</td><td><input type="text" placeholder="6. Gruppe A" /> vs <input type="text" placeholder="6. Gruppe C" /></td></tr>
          <tr data-time="10:50"><td>11:40</td><td><input type="text" placeholder="6. Gruppe C" /> vs <input type="text" placeholder="6. Gruppe B" /></td></tr>
        </table>
      </div>
    </div>

    <h2>Finale (12:20 - 12:50 Uhr)</h2>
    <p>Auf dem Centercourt spielen: Turniersieger vs. Lehrerteam (1 Satz bis 25, oder 2 Sätze bis 15 oder auf Zeit?)</p>
</body>
</html>
